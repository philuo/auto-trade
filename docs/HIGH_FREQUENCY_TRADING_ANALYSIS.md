# é«˜é¢‘åˆçº¦äº¤æ˜“ç³»ç»Ÿ - ç°çŠ¶åˆ†æä¸æ”¹è¿›æ–¹æ¡ˆ

## ğŸš¨ æ ¸å¿ƒé—®é¢˜åˆ†æ

### é—®é¢˜1ï¼šå½“å‰ä¿¡å·ç³»ç»Ÿå¯¹çŸ­æ—¶é«˜é¢‘äº¤æ˜“çš„ä»·å€¼æœ‰é™

#### å½“å‰ä¿¡å·çš„é—®é¢˜

| ä¿¡å·ç±»å‹ | å»¶è¿Ÿ | é—®é¢˜ | çŸ­æ—¶äº¤æ˜“ä»·å€¼ |
|---------|------|------|-------------|
| **MAäº¤å‰** | é«˜ï¼ˆéœ€è¦å¤šæ ¹Kçº¿ç¡®è®¤ï¼‰ | å¼ºçƒˆæ»åï¼Œå“åº”æ…¢ | â­â­â˜†â˜†â˜† ä½ |
| **MACD** | ä¸­-é«˜ | è¶‹åŠ¿ç¡®è®¤åæ‰è§¦å‘ | â­â­â˜†â˜†â˜† ä½ |
| **RSIè¶…ä¹°è¶…å–** | ä¸­ | å¯èƒ½é•¿æœŸå¤„äºæç«¯çŠ¶æ€ | â­â­â­â˜†â˜† ä¸­ |
| **å¸ƒæ—å¸¦** | ä¸­ | éœ‡è¡å¸‚åœºæœ‰æ•ˆï¼Œè¶‹åŠ¿å¸‚åœºå¤±æ•ˆ | â­â­â­â˜†â˜† ä¸­ |
| **ADX** | é«˜ | éœ€è¦è®¡ç®—å‘¨æœŸ | â­â­â˜†â˜†â˜† ä½ |

#### æ ¹æœ¬åŸå› 

1. **æŒ‡æ ‡è®¾è®¡åˆè¡·ä¸åŒ**ï¼šè¿™äº›æŒ‡æ ‡æ˜¯ä¸º**ä¸­é•¿æœŸè¶‹åŠ¿äº¤æ˜“**è®¾è®¡çš„ï¼Œä¸æ˜¯ä¸ºç§’çº§/åˆ†é’Ÿçº§é«˜é¢‘äº¤æ˜“è®¾è®¡çš„
2. **æ»åæ€§æ— æ³•é¿å…**ï¼šåŸºäºå†å²Kçº¿è®¡ç®—ï¼Œå¿…ç„¶æœ‰å»¶è¿Ÿ
3. **æ— æ³•é¢„æµ‹çªå‘äº‹ä»¶**ï¼šæ–°é—»ã€å¤§æˆ·æ“ç›˜ã€å¸‚åœºæƒ…ç»ªçªå˜æ— æ³•é€šè¿‡æŠ€æœ¯æŒ‡æ ‡é¢„æµ‹

### é—®é¢˜2ï¼šå®‰å…¨ç­–ç•¥ä¸æ»¡è¶³é«˜é¢‘äº¤æ˜“åœºæ™¯

#### å½“å‰å®‰å…¨ç­–ç•¥çš„ç¼ºå¤±

| é£é™©ç±»å‹ | å½“å‰çŠ¶æ€ | é«˜é¢‘äº¤æ˜“éœ€æ±‚ | ç¼ºå¤± |
|---------|---------|-------------|------|
| **æŒä»“æ—¶é—´é™åˆ¶** | âŒ æ—  | å¿…é¡»ä¸¥æ ¼æ§åˆ¶ | ä¸¥é‡ç¼ºå¤± |
| **åŠ¨æ€æ­¢ç›ˆæ­¢æŸ** | âŒ å›ºå®šå€¼ | éœ€è¦åŠ¨æ€è°ƒæ•´ | ä¸¥é‡ç¼ºå¤± |
| **æ»‘ç‚¹ä¿æŠ¤** | âŒ æ—  | å¿…éœ€ | ä¸¥é‡ç¼ºå¤± |
| **æµåŠ¨æ€§æ£€æŸ¥** | âŒ æ—  | å¿…éœ€ | ä¸¥é‡ç¼ºå¤± |
| **é£é™©æ•å£ç´¯ç§¯** | âŒ æ— é™åˆ¶ | å¿…é¡»é™åˆ¶ | ä¸¥é‡ç¼ºå¤± |
| **å¸‚åœºå¼‚å¸¸æ£€æµ‹** | âŒ æ—  | å¿…éœ€ | ä¸¥é‡ç¼ºå¤± |
| **è¿ç»­äºæŸä¿æŠ¤** | âš ï¸ åŸºç¡€ | éœ€è¦æ›´ç²¾ç»† | ä¸å……åˆ† |

#### é«˜é¢‘äº¤æ˜“çš„ç‰¹æ®Šé£é™©

1. **æ‰‹ç»­è´¹ä¾µèš€**ï¼šçŸ­æ—¶äº¤æ˜“æ‰‹ç»­è´¹å æ¯”é«˜ï¼Œéœ€è¦æ›´å¤§çš„ä»·æ ¼å˜åŠ¨æ‰èƒ½ç›ˆåˆ©
2. **æ»‘ç‚¹å½±å“**ï¼šå¸‚ä»·å•æˆäº¤ä»·å¯èƒ½åç¦»é¢„æœŸ
3. **æµåŠ¨æ€§é£é™©**ï¼šå¤§å•å¯èƒ½æ— æ³•å®Œå…¨æˆäº¤
4. **æŠ€æœ¯å»¶è¿Ÿ**ï¼šç½‘ç»œå»¶è¿Ÿã€APIå»¶è¿Ÿå¯èƒ½å½±å“æ‰§è¡Œ
5. **è¿‡æ‹Ÿåˆé£é™©**ï¼šå†å²æ•°æ®å­¦ä¹ çš„ç­–ç•¥å¯èƒ½åœ¨æœªæ¥å¤±æ•ˆ

### é—®é¢˜3ï¼šäº¤æ˜“æ—¥å¿—å­¦ä¹ æœºåˆ¶ä¸å®Œå–„

#### å½“å‰å­¦ä¹ æœºåˆ¶çš„é—®é¢˜

```
å½“å‰æµç¨‹ï¼š
äº¤æ˜“å®Œæˆ â†’ è®°å½•ç»“æœ â†’ æ‰‹åŠ¨åˆ†æ â†’ äººå·¥è°ƒæ•´ç­–ç•¥
              â†“
         å¯èƒ½å‡ å°æ—¶æˆ–å‡ å¤©åæ‰åˆ†æ
```

#### é—®é¢˜

1. **åé¦ˆå»¶è¿Ÿ**ï¼šäº¤æ˜“ç»“æœåˆ°ç­–ç•¥è°ƒæ•´çš„å»¶è¿Ÿå¤ªé•¿
2. **äººå·¥ä»‹å…¥**ï¼šéœ€è¦äººå·¥åˆ†æï¼Œä¸å¤Ÿè‡ªåŠ¨åŒ–
3. **ç¼ºä¹å®æ—¶è°ƒæ•´**ï¼šæ— æ³•æ ¹æ®æœ€è¿‘äº¤æ˜“åŠ¨æ€è°ƒæ•´
4. **æ ·æœ¬ä¸è¶³**ï¼šçŸ­æ—¶äº¤æ˜“éœ€è¦å¤§é‡æ ·æœ¬æ‰èƒ½å¾—å‡ºç»Ÿè®¡æ˜¾è‘—çš„ç»“è®º
5. **è¿‡æ‹Ÿåˆé£é™©**ï¼šè¿‡åº¦ä¼˜åŒ–å†å²æ•°æ®å¯èƒ½åœ¨æœªæ¥å¤±æ•ˆ

---

## âœ… æ”¹è¿›æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šé«˜é¢‘ä¸“ç”¨æŒ‡æ ‡ä½“ç³»

#### 1.1 å¾®è§‚ç»“æ„æŒ‡æ ‡ï¼ˆé€‚åˆç§’çº§/åˆ†é’Ÿçº§ï¼‰

```typescript
interface MicrostructureIndicators {
  // 1. è®¢å•æµ imbalance
  orderFlowImbalance: number;  // ä¹°å–ç›˜åŠ›é‡å¯¹æ¯” (-1åˆ°1)

  // 2. ä»·æ ¼åŠ¨èƒ½ï¼ˆçŸ­å‘¨æœŸï¼‰
  priceMomentum1m: number;     // 1åˆ†é’Ÿä»·æ ¼å˜åŒ–ç‡
  priceMomentum5m: number;     // 5åˆ†é’Ÿä»·æ ¼å˜åŒ–ç‡

  // 3. æ³¢åŠ¨ç‡ï¼ˆå®æ—¶ï¼‰
  realizedVolatility: number;  // å®ç°æ³¢åŠ¨ç‡ï¼ˆ1åˆ†é’Ÿçª—å£ï¼‰

  // 4. æˆäº¤é‡å¼‚å¸¸
  volumeSpike: number;         // æˆäº¤é‡çªå¢å€æ•°

  // 5. ä¹°å–ä»·å·®
  bidAskSpread: number;        // ä¹°å–ä»·å·®ï¼ˆæ¯”ä¾‹ï¼‰

  // 6. æ·±åº¦ imbalance
  depthImbalance: number;      // ç›˜å£æ·±åº¦ imbalance

  // 7. æˆäº¤é‡åŠ æƒå¹³å‡ä»· (VWAP)
  vwapDeviation: number;       // ä»·æ ¼åç¦»VWAPçš„ç¨‹åº¦

  // 8. ç´¯ç§¯/æ´¾ç”Ÿçº¿ï¼ˆçŸ­å‘¨æœŸï¼‰
  shortTermOBV: number;        // 1åˆ†é’ŸOBVå˜åŒ–
}
```

#### 1.2 äº‹ä»¶é©±åŠ¨ä¿¡å·ï¼ˆéçŠ¶æ€æ£€æµ‹ï¼‰

```typescript
interface EventDrivenSignals {
  // ä»·æ ¼çªç ´äº‹ä»¶
  priceBreakout: {
    level: number;            // çªç ´çš„ä»·æ ¼æ°´å¹³
    strength: number;         // çªç ´å¼ºåº¦ï¼ˆæˆäº¤é‡ï¼‰
    fakeBreakoutProb: number; // å‡çªç ´æ¦‚ç‡
  };

  // è®¢å•ç°¿å¼‚å¸¸
  orderBookAnomaly: {
    type: 'wall' | 'spoofing' | 'layering';
    severity: number;
  };

  // æˆäº¤é‡æ¿€å¢
  volumeSurge: {
    ratio: number;            // æˆäº¤é‡å€æ•°
    priceImpact: number;      // ä»·æ ¼å½±å“
  };

  // åŠ¨èƒ½è½¬æ¢
  momentumReversal: {
    from: 'bullish' | 'bearish';
    to: 'bullish' | 'bearish';
    confidence: number;
  };
}
```

#### 1.3 å®æ—¶é£é™©è¯„ä¼°

```typescript
interface RealTimeRiskMetrics {
  // 1. å¸‚åœºé£é™©
  marketRisk: {
    volatility: 'low' | 'normal' | 'high' | 'extreme';
    liquidity: 'sufficient' | 'tight' | 'dry';
    spread: 'normal' | 'wide' | 'extreme';
  };

  // 2. äº¤æ˜“é£é™©
  tradeRisk: {
    expectedSlippage: number;    // é¢„æœŸæ»‘ç‚¹
    fillProbability: number;     // æˆäº¤æ¦‚ç‡
    adverseSelectionRisk: number; // é€†å‘é€‰æ‹©é£é™©
  };

  // 3. ç³»ç»Ÿé£é™©
  systemRisk: {
    apiLatency: number;          // APIå»¶è¿Ÿ
    websocketConnected: boolean; // è¿æ¥çŠ¶æ€
    orderQueueSize: number;      // è®¢å•é˜Ÿåˆ—é•¿åº¦
  };
}
```

### æ–¹æ¡ˆ2ï¼šé«˜é¢‘ä¸“ç”¨å®‰å…¨ç­–ç•¥

#### 2.1 åŠ¨æ€æŒä»“ç®¡ç†

```typescript
class DynamicPositionManager {
  // æŒä»“æ—¶é—´é™åˆ¶
  private readonly MAX_HOLDING_TIME = {
    '1m': 60 * 1000,      // 1åˆ†é’ŸKçº¿ï¼Œæœ€å¤šæŒæœ‰1åˆ†é’Ÿ
    '5m': 5 * 60 * 1000,  // 5åˆ†é’ŸKçº¿ï¼Œæœ€å¤šæŒæœ‰5åˆ†é’Ÿ
    '15m': 15 * 60 * 1000 // 15åˆ†é’ŸKçº¿ï¼Œæœ€å¤šæŒæœ‰15åˆ†é’Ÿ
  };

  // åŠ¨æ€æ­¢ç›ˆæ­¢æŸ
  calculateDynamicStopLoss(signal: Signal, currentPrice: number): {
    stopLoss: number;
    takeProfit: number;
    reason: string;
  } {
    const atr = this.getRecentATR(signal.coin, 15); // 15å‘¨æœŸATR

    // æ­¢æŸï¼šåŸºäºATRçš„åŠ¨æ€æ­¢æŸ
    const stopLoss = signal.direction === 'bullish'
      ? currentPrice - (atr * 1.5)  // 1.5å€ATR
      : currentPrice + (atr * 1.5);

    // æ­¢ç›ˆï¼šé£é™©å›æŠ¥æ¯” 1:2
    const takeProfit = signal.direction === 'bullish'
      ? currentPrice + (atr * 3)    // 3å€ATR
      : currentPrice - (atr * 3);

    // è€ƒè™‘æ‰‹ç»­è´¹åçš„æœ€å°ç›ˆåˆ©
    const minProfit = this.calculateMinProfit(signal);

    return {
      stopLoss,
      takeProfit: Math.max(takeProfit, minProfit),
      reason: `åŸºäº${atr.toFixed(2)} ATRçš„åŠ¨æ€æ­¢ç›ˆæ­¢æŸ`
    };
  }

  // å¼ºåˆ¶å¹³ä»“æ£€æŸ¥
  checkForcedClose(position: Position): {
    shouldClose: boolean;
    reason?: string;
  } {
    const holdingTime = Date.now() - position.entryTime;

    // 1. è¶…è¿‡æœ€å¤§æŒä»“æ—¶é—´
    if (holdingTime > this.MAX_HOLDING_TIME[position.timeframe]) {
      return {
        shouldClose: true,
        reason: `è¶…è¿‡æœ€å¤§æŒä»“æ—¶é—´ ${this.MAX_HOLDING_TIME[position.timeframe] / 1000}ç§’`
      };
    }

    // 2. è¿ç»­äºæŸåæš‚åœ
    if (this.getRecentLosses() >= 3) {
      return {
        shouldClose: true,
        reason: 'è¿ç»­3æ¬¡äºæŸï¼Œæš‚åœäº¤æ˜“'
      };
    }

    return { shouldClose: false };
  }
}
```

#### 2.2 å®æ—¶é£é™©ç›‘æ§

```typescript
class RealTimeRiskMonitor {
  // æ¯ç§’æ£€æŸ¥é£é™©
  monitorRisks(): RiskAlert[] {
    const alerts: RiskAlert[] = [];

    // 1. æµåŠ¨æ€§é£é™©
    const liquidity = this.checkLiquidity();
    if (liquidity.status === 'dry') {
      alerts.push({
        type: 'liquidity',
        severity: 'high',
        message: 'å¸‚åœºæµåŠ¨æ€§ä¸è¶³ï¼Œæš‚åœæ–°å¼€ä»“',
        action: 'pause_new_trades'
      });
    }

    // 2. æ³¢åŠ¨ç‡é£é™©
    const volatility = this.checkVolatility();
    if (volatility.level === 'extreme') {
      alerts.push({
        type: 'volatility',
        severity: 'high',
        message: 'å¸‚åœºæ³¢åŠ¨ç‡æç«¯ï¼Œé™ä½ä»“ä½',
        action: 'reduce_position_size'
      });
    }

    // 3. æ•å£é£é™©
    const exposure = this.calculateExposure();
    if (exposure.percent > 80) {
      alerts.push({
        type: 'exposure',
        severity: 'critical',
        message: `é£é™©æ•å£è¿‡å¤§ ${exposure.percent}%ï¼Œç«‹å³å¹³ä»“`,
        action: 'close_all_positions'
      });
    }

    // 4. ç³»ç»Ÿé£é™©
    const system = this.checkSystemHealth();
    if (system.apiLatency > 500) {
      alerts.push({
        type: 'system',
        severity: 'high',
        message: `APIå»¶è¿Ÿè¿‡é«˜ ${system.apiLatency}msï¼Œæš‚åœäº¤æ˜“`,
        action: 'pause_trading'
      });
    }

    return alerts;
  }
}
```

#### 2.3 æ»‘ç‚¹ä¿æŠ¤

```typescript
class SlippageProtection {
  // ä¼°ç®—æ»‘ç‚¹
  estimateSlippage(signal: Signal, orderSize: number): number {
    const orderBook = this.getOrderBook(signal.coin);
    const spread = orderBook.ask - orderBook.bid;
    const spreadPercent = spread / orderBook.mid;

    // åŸºç¡€æ»‘ç‚¹ï¼šä¹°å–ä»·å·®çš„ä¸€åŠ
    let slippage = spreadPercent / 2;

    // è®¢å•è¶Šå¤§ï¼Œæ»‘ç‚¹è¶Šå¤§
    const depthImpact = this.calculateDepthImpact(orderBook, orderSize);
    slippage += depthImpact;

    return slippage;
  }

  // æ£€æŸ¥æ»‘ç‚¹æ˜¯å¦å¯æ¥å—
  isSlippageAcceptable(signal: Signal, expectedSlippage: number): boolean {
    const maxSlippage = this.getMaxAllowedSlippage(signal);

    // è€ƒè™‘æ‰‹ç»­è´¹åçš„æ€»æˆæœ¬
    const totalCost = expectedSlippage + this.getFeeRate();
    const minProfit = this.getMinProfitRate();

    return totalCost < minProfit;
  }
}
```

### æ–¹æ¡ˆ3ï¼šåŠ¨æ€å­¦ä¹ æœºåˆ¶

#### 3.1 å®æ—¶æ€§èƒ½è¿½è¸ª

```typescript
class RealTimePerformanceTracker {
  // æ»šåŠ¨çª—å£ç»Ÿè®¡
  private rollingStats = {
    windowSize: 100,  // æœ€è¿‘100ç¬”äº¤æ˜“
    trades: [] as TradeResult[],

    // è®¡ç®—æ»šåŠ¨æŒ‡æ ‡
    getMetrics() {
      const recent = this.trades.slice(-this.windowSize);

      return {
        winRate: recent.filter(t => t.pnl > 0).length / recent.length,
        avgWin: recent.filter(t => t.pnl > 0).reduce((s, t) => s + t.pnl, 0) / recent.filter(t => t.pnl > 0).length,
        avgLoss: recent.filter(t => t.pnl < 0).reduce((s, t) => s + t.pnl, 0) / recent.filter(t => t.pnl < 0).length,
        sharpe: this.calculateSharpe(recent),
        maxDrawdown: this.calculateMaxDrawdown(recent),
        currentStreak: this.getCurrentStreak()
      };
    }
  };

  // å®æ—¶æ›´æ–°
  updateStats(trade: TradeResult): void {
    this.rollingStats.trades.push(trade);

    // æ£€æŸ¥æ˜¯å¦éœ€è¦è°ƒæ•´ç­–ç•¥
    this.checkStrategyAdjustment();
  }

  // ç­–ç•¥è°ƒæ•´å»ºè®®
  checkStrategyAdjustment(): Adjustment | null {
    const metrics = this.rollingStats.getMetrics();

    // 1. è¿ç»­äºæŸä¿æŠ¤
    if (metrics.currentStreak.loss >= 3) {
      return {
        type: 'pause',
        reason: 'è¿ç»­3æ¬¡äºæŸ',
        action: 'æš‚åœäº¤æ˜“30åˆ†é’Ÿ',
        duration: 30 * 60 * 1000
      };
    }

    // 2. èƒœç‡ä¸‹é™
    if (metrics.winRate < 0.4 && this.rollingStats.trades.length >= 50) {
      return {
        type: 'reduce',
        reason: 'èƒœç‡ä½äº40%',
        action: 'é™ä½ä»“ä½è‡³50%',
        newPositionSize: 0.5
      };
    }

    // 3. å¤æ™®æ¯”ç‡ä¸‹é™
    if (metrics.sharpe < 0.5 && this.rollingStats.trades.length >= 30) {
      return {
        type: 'reduce',
        reason: 'å¤æ™®æ¯”ç‡ä½äº0.5',
        action: 'é™ä½äº¤æ˜“é¢‘ç‡',
        newInterval: '5m'  // ä»1åˆ†é’Ÿæ”¹ä¸º5åˆ†é’Ÿ
      };
    }

    return null;
  }
}
```

#### 3.2 è‡ªé€‚åº”å‚æ•°è°ƒæ•´

```typescript
class AdaptiveParameterManager {
  // åŸºäºæœ€è¿‘è¡¨ç°åŠ¨æ€è°ƒæ•´å‚æ•°
  adjustParameters(performance: PerformanceMetrics): ParameterAdjustments {
    const adjustments: ParameterAdjustments = {
      signalThreshold: {},
      positionSize: {},
      stopLossMultiplier: {},
      takeProfitMultiplier: {}
    };

    // 1. æŒ‰ä¿¡å·ç±»å‹è°ƒæ•´é˜ˆå€¼
    for (const [signalType, stats] of performance.bySignalType) {
      if (stats.winRate > 0.6 && stats.sharpe > 1.0) {
        // è¡¨ç°å¥½çš„ä¿¡å·ï¼Œé™ä½é˜ˆå€¼ï¼ˆæ›´æ•æ„Ÿï¼‰
        adjustments.signalThreshold[signalType] = {
          strength: 0.8,  // é™ä½20%
          confidence: 0.75
        };
      } else if (stats.winRate < 0.4 || stats.sharpe < 0.5) {
        // è¡¨ç°å·®çš„ä¿¡å·ï¼Œæé«˜é˜ˆå€¼ï¼ˆæ›´ä¸¥æ ¼ï¼‰
        adjustments.signalThreshold[signalType] = {
          strength: 1.2,  // æé«˜20%
          confidence: 0.85
        };
      }
    }

    // 2. æŒ‰å¸‚åœºæ¡ä»¶è°ƒæ•´ä»“ä½
    if (performance.currentMarketCondition === 'high_volatility') {
      adjustments.positionSize = {
        base: 0.5,  // é™ä½è‡³50%
        max: 0.3
      };
    }

    // 3. åŠ¨æ€æ­¢æŸæ­¢ç›ˆ
    if (performance.avgWin / performance.avgLoss < 1.5) {
      // ç›ˆäºæ¯”ä¸è¶³ï¼Œæ”¶ç´§æ­¢æŸ
      adjustments.stopLossMultiplier = {
        value: 1.2  // ä»1.5é™ä½åˆ°1.2
      };
    }

    return adjustments;
  }
}
```

#### 3.3 åœ¨çº¿å­¦ä¹ å¾ªç¯

```typescript
class OnlineLearningLoop {
  // å®æ—¶å­¦ä¹ å¾ªç¯
  async learningLoop(): Promise<void> {
    while (true) {
      // 1. ç­‰å¾…äº¤æ˜“å®Œæˆ
      const trade = await this.waitForTradeCompletion();

      // 2. ç«‹å³è®°å½•ç»“æœ
      this.recordTrade(trade);

      // 3. æ›´æ–°æ»šåŠ¨ç»Ÿè®¡
      this.updateRollingStats(trade);

      // 4. æ£€æŸ¥æ˜¯å¦éœ€è¦è°ƒæ•´
      const adjustment = this.evaluateAdjustment();
      if (adjustment) {
        this.applyAdjustment(adjustment);
      }

      // 5. æ¯10ç¬”äº¤æ˜“é‡æ–°è®­ç»ƒæ¨¡å‹
      if (this.tradeCount % 10 === 0) {
        await this.retrainModel();
      }
    }
  }

  // é‡æ–°è®­ç»ƒæ¨¡å‹
  async retrainModel(): Promise<void> {
    // 1. è·å–æœ€è¿‘çš„æ•°æ®
    const recentTrades = this.getRecentTrades(100);

    // 2. è®¡ç®—æ–°çš„æƒé‡
    const newWeights = this.calculateNewWeights(recentTrades);

    // 3. æ›´æ–°ä¿¡å·ç”Ÿæˆå™¨
    this.signalGenerator.updateWeights(newWeights);

    // 4. è®°å½•è°ƒæ•´
    this.logger.info('æ¨¡å‹å·²é‡æ–°è®­ç»ƒ', { newWeights });
  }

  // è®¡ç®—æ–°æƒé‡
  private calculateNewWeights(trades: TradeResult[]): SignalWeights {
    const weights: SignalWeights = {};

    // æŒ‰ä¿¡å·ç±»å‹åˆ†ç»„
    const byType = this.groupBySignalType(trades);

    for (const [type, typeTrades] of Object.entries(byType)) {
      const winRate = typeTrades.filter(t => t.pnl > 0).length / typeTrades.length;
      const avgPnL = typeTrades.reduce((s, t) => s + t.pnl, 0) / typeTrades.length;

      // æƒé‡ = èƒœç‡ * å¹³å‡ç›ˆåˆ©ï¼ˆæ ‡å‡†åŒ–ï¼‰
      weights[type] = this.normalize(winRate * avgPnL);
    }

    return weights;
  }
}
```

---

## ğŸ“‹ å®æ–½è·¯çº¿å›¾

### ç¬¬1é˜¶æ®µï¼šåŸºç¡€æ”¹è¿›ï¼ˆç«‹å³å®æ–½ï¼‰

1. **æ·»åŠ é«˜é¢‘ä¸“ç”¨æŒ‡æ ‡**
   - å®ç° `MicrostructureIndicators`
   - æ·»åŠ  `RealTimeRiskMetrics`
   - é›†æˆåˆ°ä¿¡å·ç”Ÿæˆæµç¨‹

2. **å¢å¼ºå®‰å…¨ç­–ç•¥**
   - å®ç°æŒä»“æ—¶é—´é™åˆ¶
   - æ·»åŠ åŠ¨æ€æ­¢ç›ˆæ­¢æŸ
   - å®ç°æ»‘ç‚¹ä¿æŠ¤
   - æ·»åŠ å®æ—¶é£é™©ç›‘æ§

### ç¬¬2é˜¶æ®µï¼šå­¦ä¹ æœºåˆ¶ï¼ˆ1-2å‘¨ï¼‰

1. **å®æ—¶æ€§èƒ½è¿½è¸ª**
   - å®ç°æ»šåŠ¨çª—å£ç»Ÿè®¡
   - æ·»åŠ è¿ç»­äºæŸä¿æŠ¤
   - å®ç°è‡ªé€‚åº”å‚æ•°è°ƒæ•´

2. **åœ¨çº¿å­¦ä¹ å¾ªç¯**
   - å®ç°äº¤æ˜“å®Œæˆåç«‹å³å­¦ä¹ 
   - æ·»åŠ æ¨¡å‹é‡æ–°è®­ç»ƒ
   - å®ç°åŠ¨æ€æƒé‡è°ƒæ•´

### ç¬¬3é˜¶æ®µï¼šä¼˜åŒ–æå‡ï¼ˆæŒç»­ï¼‰

1. **A/Bæµ‹è¯•**
   - å¯¹æ¯”ä¸åŒç­–ç•¥è¡¨ç°
   - ä¼˜åŒ–å‚æ•°é…ç½®

2. **å›æµ‹éªŒè¯**
   - ä½¿ç”¨å†å²æ•°æ®éªŒè¯
   - é¿å…è¿‡æ‹Ÿåˆ

3. **å®æ—¶ç›‘æ§**
   - ç›‘æ§ç³»ç»Ÿæ€§èƒ½
   - åŠæ—¶å‘ç°é—®é¢˜

---

## ğŸ¯ æ ¸å¿ƒå»ºè®®

### å…³äºä¿¡å·ä»·å€¼

**å½“å‰ä¿¡å·å¯¹çŸ­æ—¶é«˜é¢‘äº¤æ˜“ä»·å€¼æœ‰é™**ï¼Œå»ºè®®ï¼š

1. **å¢åŠ å¾®è§‚ç»“æ„æŒ‡æ ‡**ï¼šè®¢å•æµã€ä»·å·®ã€æ·±åº¦ç­‰
2. **ä½¿ç”¨äº‹ä»¶é©±åŠ¨ä¿¡å·**ï¼šä»·æ ¼çªç ´ã€æˆäº¤é‡æ¿€å¢ç­‰
3. **é™ä½æŠ€æœ¯æŒ‡æ ‡æƒé‡**ï¼šMA/MACDç­‰æƒé‡é™ä½åˆ°20%ä»¥ä¸‹
4. **å¢åŠ å¸‚åœºæ•°æ®æƒé‡**ï¼šè®¢å•ç°¿ã€æˆäº¤æ•°æ®æƒé‡æé«˜åˆ°60%ä»¥ä¸Š

### å…³äºå®‰å…¨ç­–ç•¥

**å½“å‰å®‰å…¨ç­–ç•¥ä¸¥é‡ä¸è¶³**ï¼Œå¿…é¡»æ·»åŠ ï¼š

1. **æŒä»“æ—¶é—´é™åˆ¶**ï¼šè¶…è¿‡è®¾å®šæ—¶é—´å¼ºåˆ¶å¹³ä»“
2. **åŠ¨æ€æ­¢ç›ˆæ­¢æŸ**ï¼šåŸºäºATRçš„åŠ¨æ€è°ƒæ•´
3. **æ»‘ç‚¹ä¿æŠ¤**ï¼šä¼°ç®—å¹¶é™åˆ¶æ»‘ç‚¹
4. **æµåŠ¨æ€§æ£€æŸ¥**ï¼šåªåœ¨æµåŠ¨æ€§å……è¶³æ—¶äº¤æ˜“
5. **å®æ—¶é£é™©ç›‘æ§**ï¼šæ¯ç§’æ£€æŸ¥é£é™©æŒ‡æ ‡

### å…³äºå­¦ä¹ æœºåˆ¶

**éœ€è¦å»ºç«‹å®æ—¶å­¦ä¹ å¾ªç¯**ï¼Œå…³é”®ç‚¹ï¼š

1. **å³æ—¶åé¦ˆ**ï¼šäº¤æ˜“å®Œæˆåç«‹å³è®°å½•
2. **æ»šåŠ¨ç»Ÿè®¡**ï¼šä½¿ç”¨æœ€è¿‘100ç¬”äº¤æ˜“è®¡ç®—
3. **è‡ªåŠ¨è°ƒæ•´**ï¼šæ ¹æ®ç»Ÿè®¡è‡ªåŠ¨è°ƒæ•´å‚æ•°
4. **é˜²æ­¢è¿‡æ‹Ÿåˆ**ï¼šä½¿ç”¨éªŒè¯é›†ï¼Œå®šæœŸé‡æ–°è¯„ä¼°

---

## âš ï¸ é‡è¦è­¦å‘Š

1. **çŸ­æ—¶é«˜é¢‘äº¤æ˜“é£é™©æé«˜**ï¼šéœ€è¦å……åˆ†æµ‹è¯•å’ŒéªŒè¯
2. **æ‰‹ç»­è´¹å½±å“å·¨å¤§**ï¼šéœ€è¦æ›´é«˜çš„ç›ˆåˆ©ç›®æ ‡
3. **æ»‘ç‚¹ä¸å¯é¿å…**ï¼šå¿…é¡»è€ƒè™‘æ»‘ç‚¹æˆæœ¬
4. **è¿‡æ‹Ÿåˆé£é™©**ï¼šå†å²è¡¨ç°ä¸ä»£è¡¨æœªæ¥
5. **ç³»ç»Ÿç¨³å®šæ€§å…³é”®**ï¼šä»»ä½•å»¶è¿Ÿéƒ½å¯èƒ½å¯¼è‡´æŸå¤±

**å»ºè®®**ï¼šå…ˆç”¨å°èµ„é‡‘ã€ä½é¢‘ç‡æµ‹è¯•ï¼ŒéªŒè¯æœ‰æ•ˆæ€§åå†é€æ­¥æé«˜é¢‘ç‡å’Œèµ„é‡‘ã€‚
