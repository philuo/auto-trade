# OKX 量化交易系统

## 项目概述

一个**24/7无人值守**的加密货币量化交易系统，结合现货和合约策略，实现安全稳定的自动化交易。

### 核心特性

- **双策略组合**：现货稳健 + 合约进攻
- **无人值守**：24/7自动运行，自动故障恢复
- **多层风险控制**：策略级、组合级、系统级三重防护
- **数据驱动**：基于统计验证，不依赖主观判断

---

## 快速开始

### 1. 安装依赖

```bash
bun install
```

### 2. 配置环境变量

```bash
cp .env.example .env
# 编辑 .env 文件，填入 OKX API 配置
```

### 3. 申请模拟盘 API

1. 登录 [www.okx.com](https://www.okx.com)
2. 进入「模拟交易」→「个人中心」
3. 创建 API Key（选择读取 + 交易权限）

### 4. 启动系统

```bash
# 启动完整系统（现货 + 合约）
bun run start

# 或仅启动现货策略
bun run strategy
```

---

## 系统架构

### 双策略组合

```
┌──────────────────┐        ┌──────────────────┐
│   现货策略       │        │   合约策略       │
│  (DCA-Grid)      │        │  (技术分析)      │
│                  │        │                  │
│  • DCA定投       │        │  • 事件驱动      │
│  • 网格交易      │        │  • ADX过滤       │
│  • 稳健盈利      │        │  • 统计验证      │
│  • 零爆仓风险    │        │  • 高胜率        │
└────────┬─────────┘        └────────┬─────────┘
         │                          │
         └──────────┬───────────────┘
                    ▼
         ┌──────────────────┐
         │  统一风险管理     │
         └──────────────────┘
```

### 资金配置（10,000 USDT示例）

| 分配 | 金额 | 策略 | 风险 |
|------|------|------|------|
| 现货 | 6,000 | DCA-Grid | 低 |
| 合约 | 2,000 | 技术分析 | 中 |
| 储备 | 2,000 | 应急 | 无 |

---

## 策略说明

### 现货策略（DCA-Grid）

| 特性 | 配置 |
|------|------|
| 目标 | 长期积累筹码，稳健增值 |
| 币种 | BNB, SOL, XRP, ADA, DOGE |
| 杠杆 | 无（现货） |
| 策略 | DCA定投 + 网格交易 |
| 预期年化 | 30-50% |

**运作方式：**
- 下跌 → DCA逆向买入
- 震荡 → 网格高抛低吸
- 上涨 → 网格逐步卖出

### 合约策略（技术分析）

| 特性 | 配置 |
|------|------|
| 目标 | 高胜率短线交易 |
| 币种 | BTC, ETH |
| 杠杆 | 2x |
| 策略 | 事件驱动 + 统计验证 |
| 预期胜率 | 55-65% |

**信号示例：**
- MA7上穿MA25 → 检查ADX
- ADX > 25 → 查询历史胜率
- 胜率 > 50% → 计算置信度
- 置信度 > 65% → 执行交易

---

## 风险控制

### 三层防护

| 层级 | 措施 |
|------|------|
| 策略级 | 现货无杠杆，合约2x，止损2% |
| 组合级 | 现货60%，合约20%，储备20% |
| 系统级 | 极端行情自动暂停，断线重连 |

### 熔断条件

| 条件 | 阈值 | 动作 |
|------|------|------|
| 单K线涨跌 | > ±10% | 暂停新开仓 |
| 总回撤 | > 20% | 暂停所有交易 |
| 网络断线 | 30秒 | 自动重连 |

---

## 运行命令

| 命令 | 说明 |
|------|------|
| `bun run start` | 启动完整系统 |
| `bun run strategy` | 仅启动现货策略 |
| `bun test` | 运行测试 |

---

## 项目范围

支持**现货交易（SPOT）**和**永续合约（SWAP）**两种交易模式。

### 业务规则限制

| 规则 | 说明 |
|------|------|
| 禁止借币 | 不允许任何形式的借币操作 |
| 杠杆限制 | BTC ≤ 5x，ETH ≤ 3x，其它币种仅现货 |
| 币种限制 | 仅 BTC、ETH、BNB、SOL、XRP、ADA、DOGE |

### 支持的交易币种

| 币种 | 现货 | 合约 | 最大杠杆 |
|------|:----:|:----:|:--------:|
| BTC | ✅ | ✅ | 5x |
| ETH | ✅ | ✅ | 3x |
| BNB | ✅ | ❌ | - |
| SOL | ✅ | ❌ | - |
| XRP | ✅ | ❌ | - |
| ADA | ✅ | ❌ | - |
| DOGE | ✅ | ❌ | - |

---

## 文档导航

### 核心文档

| 文档 | 说明 | 适合人群 |
|------|------|---------|
| **[UNATTENDED_TRADING_SYSTEM.md](./UNATTENDED_TRADING_SYSTEM.md)** | 无人值守系统设计 | 所有用户 |
| **[STRATEGIES.md](./STRATEGIES.md)** | 策略详细说明 | 交易者 |
| **[TECHNICAL_ANALYSIS.md](./TECHNICAL_ANALYSIS.md)** | 技术分析系统 | 开发者 |
| **[QUICK_START.md](./QUICK_START.md)** | 快速开始指南 | 所有用户 |
| **[API_REFERENCE.md](./API_REFERENCE.md)** | API 接口文档 | 开发者 |
| **[SAFETY_GUIDE.md](./SAFETY_GUIDE.md)** | 安全风险指南 | 所有用户 |

---

## 项目结构

```
okx-trade/
├── src/
│   ├── main/                      # 主入口
│   │   └── unattended-trading.ts  # 无人值守交易系统
│   ├── strategies/                # 交易策略
│   │   ├── spot-dca-grid/         # 现货DCA-Grid策略
│   │   └── neutral-safe/          # 中性安全策略
│   ├── trading/                   # 交易协调
│   │   └── technical-coordinator.ts
│   ├── indicators/                # 技术指标
│   ├── signals/                   # 信号生成
│   ├── statistics/                # 统计验证
│   ├── risk/                      # 风险控制
│   ├── api/                       # REST API
│   └── websocket/                 # WebSocket客户端
├── tests/                         # 测试文件
├── docs/                          # 文档目录
└── data/                          # 生产数据库
```

---

## 外部资源

- [OKX API 官方文档](https://www.okx.com/docs-v5/zh/#overview)
- [Bun 官方文档](https://bun.sh/docs)
- [TypeScript 官方文档](https://www.typescriptlang.org/docs)

---

## 安全提示

⚠️ **重要提醒**：
1. 不要将 API Key 提交到版本控制
2. 先在模拟盘充分测试
3. 设置合理的风险控制参数
4. 严格遵守业务规则限制
5. 保留应急储备，不要满仓操作
