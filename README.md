# OKX 量化交易系统

24/7 无人值守的自动化交易系统 | 现货稳健 + 合约进攻 | 数据驱动

## 快速开始

### 1. 安装依赖

```bash
bun install
```

### 2. 安装 PM2（进程管理器）

```bash
npm install -g pm2
```

### 3. 配置环境变量

```bash
cp .env.example .env
# 编辑 .env 文件，填入 OKX API 配置
```

**必需的环境变量：**
```
OKX_API_KEY=your_api_key
OKX_SECRET_KEY=your_secret_key
OKX_PASSPHRASE=your_passphrase
```

**可选的环境变量：**
```
HTTP_PROXY=http://127.0.0.1:7890  # 代理（如需要）
NODE_ENV=production                # 生产环境
```

### 4. 申请模拟盘 API

1. 登录 [www.okx.com](https://www.okx.com)
2. 进入「模拟交易」→「个人中心」
3. 创建 API Key（选择读取 + 交易权限）

### 5. 启动系统

```bash
bun run start
```

**系统将自动执行以下检测：**
1. ✅ 环境变量检测
2. ✅ PM2 安装检测
3. ✅ API 连通性检测
4. ✅ 数据访问检测

**检测通过后自动启动，检测失败立即中断并报错提示。**

---

## 运行命令

| 命令 | 说明 |
|------|------|
| `bun run start` | 启动系统（自动检测配置） |
| `bun run start:pm2` | 直接使用 PM2 启动 |
| `bun run start:dev` | 开发模式启动（不使用 PM2 daemon） |
| `bun run stop` | 停止系统 |
| `bun run restart` | 重启系统 |
| `bun run delete` | 删除系统 |
| `bun run logs` | 查看日志 |
| `bun run monit` | 实时监控 |

---

## 系统架构

### 双策略组合

```
┌──────────────────┐        ┌──────────────────┐
│   现货策略       │        │   合约策略       │
│  (DCA-Grid)      │        │  (技术分析)      │
│                  │        │                  │
│  • DCA定投       │        │  • 事件驱动      │
│  • 网格交易      │        │  • ADX过滤       │
│  • 稳健盈利      │        │  • 统计验证      │
│  • 零爆仓风险    │        │  • 高胜率        │
└────────┬─────────┘        └────────┬─────────┘
         │                          │
         └──────────┬───────────────┘
                    ▼
         ┌──────────────────┐
         │  统一风险管理     │
         │  三层防护机制     │
         └──────────────────┘
```

### 资金配置（10,000 USDT示例）

| 分配 | 金额 | 策略 | 风险 |
|------|------|------|------|
| 现货 | 6,000 | DCA-Grid | 低 |
| 合约 | 2,000 | 技术分析 | 中 |
| 储备 | 2,000 | 应急 | 无 |

---

## 风险控制

### 三层防护

| 层级 | 措施 |
|------|------|
| 策略级 | 现货无杠杆，合约2x，止损2% |
| 组合级 | 现货60%，合约20%，储备20% |
| 系统级 | 极端行情暂停，断线重连 |

### 熔断条件

| 条件 | 阈值 | 动作 |
|------|------|------|
| 单K线涨跌 | > ±10% | 暂停新开仓 |
| 总回撤 | > 20% | 暂停所有交易 |
| 网络断线 | 30秒 | 自动重连 |

---

## 支持的交易币种

| 币种 | 现货 | 合约 | 最大杠杆 |
|------|:----:|:----:|:--------:|
| BTC | ✅ | ✅ | 5x |
| ETH | ✅ | ✅ | 3x |
| BNB | ✅ | ❌ | - |
| SOL | ✅ | ❌ | - |
| XRP | ✅ | ❌ | - |
| ADA | ✅ | ❌ | - |
| DOGE | ✅ | ❌ | - |

---

## 文档

详细文档请查看 [docs/README.md](./docs/README.md)

---

## 安全提示

⚠️ **重要提醒**：
1. 不要将 API Key 提交到版本控制
2. 先在模拟盘充分测试
3. 设置合理的风险控制参数
4. 严格遵守业务规则限制
5. 保留应急储备，不要满仓操作

---

## 免责声明

本项目仅用于个人学习金融知识，无其他任何用途！不收取任何费用！

**实盘 API 会对资产造成实际影响！请务必小心！！如果您不懂代码切记不可使用！！！**

## OKX文档

- [接口文档](https://www.okx.com/docs-v5/zh/)
- [最佳实践](https://www.okx.com/docs-v5/trick_zh/#instrument-configuration)
- [更新日志](https://www.okx.com/docs-v5/log_zh/#upcoming-changes)